<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Discompress â€” Under 10MB for Discord</title>
<meta name="description" content="Shrink any video to under 10MB. One button. Done.">
<style>
  :root{
    --bg:#0b0b12; --card:#141422; --text:#eaf2ff;
    --a:#27f1ff; --b:#ff4df0; --muted:#9aa3b2;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--text); font:500 16px/1.5 system-ui,Segoe UI,Inter,Roboto;
    background:
      radial-gradient(1200px 600px at 85% -10%, #1a1a30 0%, transparent 60%),
      radial-gradient(900px 500px at -10% 110%, #17172a 0%, transparent 60%),
      var(--bg);
    display:grid; place-items:center; padding:24px;
  }
  .wrap{width:min(720px,92vw)}
  .frame{
    padding:2px; border-radius:22px;
    background:linear-gradient(135deg,var(--a),var(--b));
    filter:drop-shadow(0 12px 40px rgba(0,0,0,.35));
    animation:pulse 7s ease-in-out infinite;
  }
  .card{background:var(--card); border-radius:20px; padding:36px}
  h1{margin:0 0 6px; font-size:28px; letter-spacing:.2px}
  p.top{margin:0 0 22px; color:var(--muted)}
  .cta{
    display:grid; place-items:center; gap:12px; text-align:center;
    padding:36px; border-radius:16px;
    background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(0,0,0,.10));
  }

  /* The ONE BUTTON */
  #pick{
    --pad:18px;
    position:relative; border:0; cursor:pointer; user-select:none;
    padding:var(--pad) calc(var(--pad) * 1.5);
    border-radius:18px; font-weight:800; letter-spacing:.4px;
    color:#0a0a12; background:transparent; isolation:isolate;
    transition:transform .15s ease;
  }
  #pick:active{ transform:translateY(1px) }
  /* gradient ring */
  #pick::before{
    content:""; position:absolute; inset:0; border-radius:16px; padding:2px;
    background:linear-gradient(135deg,var(--a),var(--b));
    -webkit-mask:
      linear-gradient(#000 0 0) content-box,
      linear-gradient(#000 0 0);
    -webkit-mask-composite: xor; mask-composite: exclude;
    z-index:-1;
  }
  /* inner fill + animated shimmer */
  #pick::after{
    content:""; position:absolute; inset:4px; border-radius:14px;
    background:
      linear-gradient(135deg, rgba(255,255,255,.08), rgba(255,255,255,.02)),
      radial-gradient(120% 200% at 0% 0%, rgba(39,241,255,.25), transparent 60%),
      radial-gradient(120% 200% at 100% 100%, rgba(255,77,240,.25), transparent 60%),
      #0f1022;
    z-index:-1;
  }
  .glow{
    position:absolute; inset:-18px; border-radius:22px; z-index:-2;
    background:radial-gradient(180px 80px at 50% 20%, rgba(39,241,255,.5), transparent 60%),
               radial-gradient(180px 80px at 50% 80%, rgba(255,77,240,.5), transparent 60%);
    filter:blur(18px); opacity:.55; transition:opacity .2s ease;
    pointer-events:none;
  }
  #pick:hover + .glow, #pick:focus-visible + .glow{opacity:.85}
  .hint{color:var(--muted); font-size:13px}

  /* Progress */
  .bar{width:100%; height:10px; background:#1e2035; border-radius:999px; overflow:hidden}
  .fill{width:0%; height:100%;
        background:linear-gradient(90deg,var(--a),var(--b)); transition:width .09s linear}
  .status{font-size:13px; color:var(--muted)}

  @keyframes pulse{
    0%,100%{filter:drop-shadow(0 12px 40px rgba(0,0,0,.35))}
    50%{filter:drop-shadow(0 18px 54px rgba(0,0,0,.45))}
  }
  footer{margin-top:18px; text-align:center; opacity:.55; font-size:12px}
  a, a:visited{color:var(--a); text-decoration:none}
</style>
</head>
<body>
  <div class="wrap">
    <div class="frame">
      <div class="card">
        <h1>Discompress</h1>
        <p class="top">Upload a video. Get it back under <b>10&nbsp;MB</b>. One button.</p>

        <div class="cta">
          <input id="file" type="file" accept="video/*" hidden>
          <button id="pick">Upload Video</button>
          <div class="glow" aria-hidden="true"></div>
          <div class="hint">Perfect for Discordâ€™s 10&nbsp;MB limit.</div>

          <div style="width:100%; margin-top:10px">
            <div class="bar"><div id="fill" class="fill"></div></div>
            <div id="status" class="status">Idle</div>
          </div>
        </div>
      </div>
    </div>
    <footer>No ads. No clutter. Just smaller files.</footer>
  </div>

<script>
  // ðŸ”— Set your backend URL here:
  const RENDER_URL = 'https://discompress.onrender.com'; // <-- change if your Render URL differs
  const API = RENDER_URL + '/api/upload';

  const btn = document.getElementById('pick');
  const input = document.getElementById('file');
  const fill = document.getElementById('fill');
  const statusEl = document.getElementById('status');

  btn.addEventListener('click', ()=> input.click());
  input.addEventListener('change', ()=>{
    const f = input.files && input.files[0];
    if (f) upload(f);
  });

  function setStatus(t){ statusEl.textContent = t; }
  function setProgress(p){ fill.style.width = Math.max(0, Math.min(100, p)) + '%'; }

  function upload(file){
    // Reset UI
    setProgress(0); setStatus('Preparingâ€¦');

    const form = new FormData();
    form.append('video', file);

    const xhr = new XMLHttpRequest();
    xhr.open('POST', API, true);
    xhr.responseType = 'blob';

    // Upload progress (0 â†’ ~80%)
    xhr.upload.onprogress = (e)=>{
      if (!e.lengthComputable) return;
      const up = (e.loaded / e.total) * 80;           // cap at 80
      setProgress(Math.round(up));
      setStatus(`Uploadingâ€¦ ${Math.round((e.loaded/e.total)*100)}%`);
    };

    // Pretend processing progress (80 â†’ 99%) while server works
    let procTimer = null;
    xhr.onreadystatechange = ()=>{
      if (xhr.readyState === 2){       // headers received -> server started processing
        setStatus('Processingâ€¦');
        // Smoothly tick from current to 99% while waiting
        let p = Math.max(parseInt(fill.style.width) || 80, 80);
        clearInterval(procTimer);
        procTimer = setInterval(()=>{
          if (p < 99) { p += 0.25; setProgress(p); }
        }, 120);
      }
      if (xhr.readyState === 4){
        clearInterval(procTimer);
        if (xhr.status === 200){
          setProgress(100);
          setStatus('Downloadingâ€¦');
          const blob = xhr.response;
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = 'discompress_video.mp4';
          a.click();
          URL.revokeObjectURL(url);
          setStatus('Done âœ…');
        } else {
          setStatus('Failed. Try a shorter clip or a lower-bitrate source.');
        }
      }
    };

    xhr.onerror = ()=> setStatus('Network error. Try again.');
    xhr.send(form);
  }
</script>
</body>
</html>
